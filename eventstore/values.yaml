#Default values for eventstoredb deployment
#Ensure that you provide the relevant values for the public URLs

#Configure the eventstore cluster
deployment:
  
  clusterSize: 3
  
  #Public Node hostnames
  #Will be set on ingress controller
  #Note that strange errors will occur if a host is not provided for all cluster nodes
  hosts:
    '0': 'a.esdb.example.com'
    '1': 'b.esdb.example.com'
    '2': 'c.esdb.example.com'
  
  #Configure storage for EventStore data
  storage:
    class: premium
    annotations: {}
    size: 100Gi

  #Custom eventstore config YAML
  #Note that we can use actual YAML here (rather than a string)
  config:
    shared:
      RunProjections: All

    '0': { }
    '1': { }
    '2': { }
    
  logs:
    #If this is disabled, then an emptydir will be mounted for /logs
    #Set to true if you wish to persist logs with a PVC
    persist: false
    storage:
      #By default, the maximum log file size for
      #EventstoreDB is 1 GB
      class: standard
      annotations: {}
      size: 1Gi
  
  
  #Configure reverse proxy container
  proxy:
    image:
      repository: jeremysv/eventstoreproxy
      tag: latest
      imagePullPolicy: IfNotPresent
      
    #Configure the proxy resource limits
    resources: {}
#      requests:
#        memory: 64Mi
#        cpu: 64m
#      limits:
#        memory: 512Mi
#        cpu: 512m
  
  #Configure the eventstore container
  esdb:
    image:
      repository: eventstore/eventstore
      #If tag is not provided, then chart [appversion]-bionic will be used
      tag: ""
      pullPolicy: IfNotPresent
      
    # The liveness probe on a cluster node fails when the cluster is invalid
    # For liveness, if the cluster is briefly invalid, do not kill the node
    
    # Default 1 Minute
    liveness:
      failureThreshold: 6
      periodSeconds: 10
      
    #Configure the node resource limits
    resources: {}
#      requests:
#        memory: 128Mi
#        cpu: 250m
#      limits:
#        memory: 2Gi
#        cpu: '2'
    
  
  #StatefulSet annotations
  annotations: {}
  
  podAnnotations: {}
  
  nodeSelector: {}
  
  terminationGracePeriodSeconds: 120
  
  podSecurityContext:
    #The default eventstore images run as the user eventstore:1000
    fsGroup: 1000
    
  affinity: {}

#Configure the ingress resource
#Backend protocol must be http2/grpc
ingress:
  tlsSecretName: ""
  class: ""
  annotations: {}

#Configure the service account to run under
serviceAccount:
  create: true
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is automatically generated
  name: ""

#Configure the helper CLI images (used by certificate setup job)
cliImages:
  genCerts:
    repository: eventstore/es-gencert-cli
    tag: latest
    pullPolicy: Always
  kubectl:
    repository: bitnami/kubectl
    tag: latest
    pullPolicy: Always

#Configure certificate validity in days
certificatesLength:
  ca: 3650
  node: 3650

imagePullSecrets: { }
